---
title: "Burden of Disease Report" 
subtitle: "Non-Communicable Disease Burden (NCD)" 
author: "Sisay Wondaya","Jingchao Feng" 
output: rmarkdown::github_document date: "`r Sys.Date()`"
---

```{r }
# Load necessary packages
pacman::p_load(tidyverse, knitr, here, ggplot2)

# Import the non-communicable diseases data
data_ncd <- read_csv(here("data/burden-of-disease-ncd.csv"))
head(data_ncd, 5)
```

# Filtering the necessary dataset

```{r}
# Filter the dataset to include only the three countries chosen by your group.
data_ncd_mini <- data_ncd %>%
  filter(Entity %in% c("India","China", "Ghana","Ethiopia"))
```

Non-Communicable Disease Burden (NCD)ï¼š India,China,Ghana, Ethiopia

# Table of Estimates for NCD Burden Over Time

```{r}
# Here render a table for the DALY burden over time for the three countries. 
data_ncd_wide <- data_ncd_mini %>%
  pivot_wider(names_from = Entity,
             values_from = `DALYs (Disability-Adjusted Life Years) - Non-communicable diseases - Sex: Both - Age: Age-standardized (Rate)`, values_fill = list(`DALYs (Disability-Adjusted Life Years) - Non-communicable diseases - Sex: Both - Age: Age-standardized (Rate)` = 0))
kable(data_ncd_wide)

data_ncd_summary <- data_ncd_mini %>%
  group_by(Code) %>%
  summarise(
    mean_DALY = mean(`DALYs (Disability-Adjusted Life Years) - Non-communicable diseases - Sex: Both - Age: Age-standardized (Rate)`),
    median_DALY = median(`DALYs (Disability-Adjusted Life Years) - Non-communicable diseases - Sex: Both - Age: Age-standardized (Rate)`),
    std_DALY = sd(`DALYs (Disability-Adjusted Life Years) - Non-communicable diseases - Sex: Both - Age: Age-standardized (Rate)`),
    min_DALY = min(`DALYs (Disability-Adjusted Life Years) - Non-communicable diseases - Sex: Both - Age: Age-standardized (Rate)`),
    max_DALY = max(`DALYs (Disability-Adjusted Life Years) - Non-communicable diseases - Sex: Both - Age: Age-standardized (Rate)`),
    n_obs = n()
  )
kable(data_ncd_summary)
```

# Plot Showing Trends in NCD Burden Over Time

```{r}
# Here, plot a line graph showing the trend of DALY burden for the chosen countries over time. You can use ggplot2 to create this plot. Each country's line should be a different color.
ggplot(data_ncd_mini, aes(x = Year, y = `DALYs (Disability-Adjusted Life Years) - Non-communicable diseases - Sex: Both - Age: Age-standardized (Rate)`, color = Entity, group = Entity)) +
  geom_line(size = 1.2) +                # Line size
  geom_point(size = 3) +                 # Adding points to the line
  labs(title = "DALY Burden Trend Over Time", 
       x = "Year", 
       y = "DALY Burden",
       color = "Country") +              # Label for color legend
  theme_minimal()  

```

# Summary of NCD Burden Findings

Provide a brief analysis based on the data presented in the table and chart. Highlight any significant findings or patterns. About 3 sentences. 1 Table: data_ncd_summary shows that the largest mean_DALY is in India, the largest DALYs are found in Ethiopia 29898.41, and the smallest DALYs are found in China 18058.96 2 Figure: It can be seen that DALYs of all the five countries have shown a significant decline in 30 years, indicating an improvement in health status. The faster rate of decline is seen in Ethiopia and China and the slower change is seen in Ghana and India. 3 The mean and median DALYs of these four countries are very close to each other but differ in standard deviation, which reflects the dispersion of the data. Ethiopia's DALY value has the largest standard deviation, indicating that its data has the highest variability among the four countries. Ghana, on the other hand, has the smallest standard deviation of DALY values, indicating that its data are the most stable among the four countries.

From the finding we observe that China and Ethiopia has shown a remarkable decline in the DALY from 1990 to 2020. On the other hand, Ghana has shown a steady change over tthe specified period. Among the four country, the maximum DALY value was seen by Ethiopians In the late time back in 1990 while the min is by Chinese in 2020.
